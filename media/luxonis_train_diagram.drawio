<mxfile host="Electron" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.6 Chrome/138.0.7204.100 Electron/37.2.3 Safari/537.36" version="28.0.6">
  <diagram name="Page-1" id="Zw9uV29fOMbzmkmFfnGz">
    <mxGraphModel dx="5924" dy="3286" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="_37iejXVek1QUt4RPsA0-9" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="609" y="-263" width="440" height="600" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="-143" y="-267" width="600" height="960" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-2" value="&lt;font face=&quot;Courier New&quot;&gt;EfficientRep&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="47" y="-257" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="_37iejXVek1QUt4RPsA0-3" target="_37iejXVek1QUt4RPsA0-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-3" value="&amp;nbsp;def forward(inputs: Tensor):&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;features = []&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return features&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1.9899999999999984" y="227" width="330" height="120" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="_37iejXVek1QUt4RPsA0-4" target="_37iejXVek1QUt4RPsA0-19" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="591" />
              <mxPoint x="560" y="-133" />
            </Array>
            <mxPoint x="750" y="-80" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-4" value="&amp;nbsp;def wrap(&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;output: list[Tensor]&lt;/div&gt;&lt;div&gt;&amp;nbsp;) -&amp;gt; Packet:&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;features&quot;: features,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="-27.379999999999995" y="512.5" width="388.75" height="155" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-8" value="&amp;nbsp;attach_index = -1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="277" y="-277" width="195" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-10" value="&lt;font face=&quot;Courier New&quot;&gt;RepPANNeck&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="749" y="-241" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="_37iejXVek1QUt4RPsA0-11" target="_37iejXVek1QUt4RPsA0-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-11" value="&amp;nbsp;def forward(inputs: list[Tensor]):&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;features = []&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return features&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="644.75" y="-50" width="368.5" height="130" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="_37iejXVek1QUt4RPsA0-12" target="_37iejXVek1QUt4RPsA0-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-12" value="&amp;nbsp;def wrap(&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;output:&amp;nbsp; list[Tensor]&lt;/div&gt;&lt;div&gt;&amp;nbsp;) -&amp;gt; Packet:&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;features&quot;: features,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="670.5" y="136" width="317" height="144" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="_37iejXVek1QUt4RPsA0-19" target="_37iejXVek1QUt4RPsA0-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-19" value="&amp;nbsp;def unwrap(inputs: list[Packet]):&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return inputs[0][&quot;features&quot;]&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="647.5" y="-173" width="363" height="80" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-18" value="&amp;nbsp;attach_index = &quot;all&quot;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="939" y="-281" width="225.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-27" value="&lt;font&gt;The raw outputs from &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;forward&lt;/font&gt;&amp;nbsp;&amp;nbsp;are sent to the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;wrap&lt;/font&gt;&amp;nbsp;&amp;nbsp;method which constructs a packet out of them. The default &lt;font face=&quot;Helvetica&quot;&gt;implementation creates a packet with a single&lt;/font&gt;&amp;nbsp;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;&quot;features&quot;&lt;/font&gt; key.&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;fontSize=17;base=40;size=21;position=0.58;position2=0.81;" parent="1" vertex="1">
          <mxGeometry x="-253" y="369" width="380" height="145" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="_37iejXVek1QUt4RPsA0-31" target="_37iejXVek1QUt4RPsA0-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-31" value="&amp;nbsp;def unwrap(&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;inputs: list[Packet]&lt;/div&gt;&lt;div&gt;&amp;nbsp;) -&amp;gt; Tensor | list[Tensor]:&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return inputs[0][&quot;features&quot;]&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="-66.76" y="-70" width="467.5" height="100" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="_37iejXVek1QUt4RPsA0-35">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="97" y="-270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-35" value="" style="verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;strokeWidth=1;shape=mxgraph.mockup.misc.map;" parent="1" vertex="1">
          <mxGeometry x="-223" y="-580" width="250" height="250" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-38" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;The input image is initially wrapped into a packet with a single &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;&quot;features&quot;&lt;/font&gt; key&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;position2=0;size=30;position=0.21;" parent="1" vertex="1">
          <mxGeometry x="46.99" y="-570" width="240" height="110" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-26" value="&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;forward&lt;/span&gt;&amp;nbsp;expects a list of tensors, therefore the&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;attach_index&lt;/span&gt;&amp;nbsp;is automatically set to&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;&quot;all&quot;&lt;/span&gt;, meaning all the features in the list are passed to the&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;forward&lt;/span&gt;&amp;nbsp;method." style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=20;position=0.6;position2=0.79;fontSize=17;base=29;" parent="1" vertex="1">
          <mxGeometry x="644" y="-403" width="370" height="130" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-24" value="&lt;font&gt;The default &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;unwrap&lt;/font&gt;&amp;nbsp;looks for a key called&amp;nbsp;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;&quot;features&quot;&lt;/font&gt;&amp;nbsp;. In case the value is a list, &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;attach_index&lt;/font&gt; is used to return the correct value. In the other case (the value is a bare tensor) it is returned as is&lt;font&gt;. For majority of cases the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;unwrap&lt;/font&gt; method can be safely ignored.&lt;/font&gt;&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;fontSize=17;size=30;position=0.51;base=21;position2=0.4;direction=west;" parent="1" vertex="1">
          <mxGeometry x="-343" y="23" width="450" height="180" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-28" value="&amp;nbsp;task = None" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="277" y="-224" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-29" value="&lt;span style=&quot;font-size: 17px;&quot;&gt;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;Packet&lt;/font&gt; is a type alias for &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;dict[str, Tensor | list[Tensor]]&lt;/font&gt;. Individual nodes send data to each other and to attached modules (losses, metrics, visualizers) using these packets.&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;position2=0.63;size=60;position=0.47;" vertex="1" parent="1">
          <mxGeometry x="-133" y="-200" width="380" height="160" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-30" value="&lt;font&gt;If &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;attach_index&lt;/font&gt; is not explicitly set, it is inferred from the type signature of &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;forward&lt;/font&gt;. In this case&amp;nbsp;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;forward&lt;/font&gt; expects a single tensor, meaning the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;attach_index&lt;/font&gt; is set to &lt;font face=&quot;Courier New&quot;&gt;-1.&lt;/font&gt;&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=30;position=0.45;position2=0.63;base=40;fontSize=17;direction=east;" parent="1" vertex="1">
          <mxGeometry x="117" y="-419" width="400" height="150" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-30" value="&lt;span style=&quot;font-size: 17px;&quot;&gt;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;EfficientRep&lt;/font&gt; node is a backbone and as such does not specify any &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;task&lt;/font&gt;.&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;position2=0.68;direction=west;" vertex="1" parent="1">
          <mxGeometry x="297" y="-187" width="240" height="110" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-31" value="&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;wrap&lt;/font&gt; typically only needs to be overriden for head nodes." style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;fontSize=17;base=29;size=29;position=0.31;position2=0.18;" vertex="1" parent="1">
          <mxGeometry x="194" y="425" width="278" height="89" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-32" value="&amp;nbsp;task = None" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="939" y="-228" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-66" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="38.5" y="790" width="414" height="360" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-67" value="&lt;font face=&quot;Courier New&quot; style=&quot;font-size: 19px;&quot;&gt;BBoxVisualizer&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="118.5" y="810" width="245" height="30" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-68" value="&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp;def forward(&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;self,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;predictions: Tensor,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;targets: Tensor,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp;): ...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;spacing=0;labelBorderColor=none;textShadow=0;fontSize=17;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="96" y="940" width="290" height="160" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-70" value="&amp;nbsp;supported_tasks = [Tasks.BOUNDINGBOX]" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="48" y="860" width="395" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-39" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="609" y="400" width="440" height="900" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-57" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="_37iejXVek1QUt4RPsA0-41" target="_37iejXVek1QUt4RPsA0-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-41" value="&amp;nbsp;def forward(inputs: Tensor):&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;...&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return features, cls, reg&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="640.8329466357309" y="650" width="386.54292343387476" height="81" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-42" value="&amp;nbsp;def wrap(output: tuple):&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;features, cls, reg = output&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;if self.export:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;return {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;boundibgbox&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;elif self.training:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;return {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;features&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;class_scores&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;distributions&quot;: ...&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;else:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp; &amp;nbsp;return {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;features&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;class_scores&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;distributions&quot;: ...,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;boundingbox&quot;: ...,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;}&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="628.9055916473318" y="820" width="410.41763341067286" height="450" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="_37iejXVek1QUt4RPsA0-45" target="_37iejXVek1QUt4RPsA0-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-45" value="&amp;nbsp;def unwrap(&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;inputs: list[Packet]&lt;/div&gt;&lt;div&gt;&amp;nbsp;) -&amp;gt; Tensor:&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;return inputs[0][&quot;features&quot;][attach_index]&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="628.9" y="490" width="410.42" height="120" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-52" value="&lt;font face=&quot;Courier New&quot;&gt;EfficientBBoxHead&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="694.8345939675174" y="416.5" width="278.538283062645" height="30" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-58" value="The &lt;font face=&quot;Helvetica&quot;&gt;output&lt;/font&gt; of &lt;font face=&quot;Courier New&quot;&gt;forward&lt;/font&gt; is directly passed to &lt;font face=&quot;Courier New&quot;&gt;wrap&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=20;position=0.18;position2=0.13;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="843.2" y="740" width="275.8" height="87" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-64" value="&amp;nbsp;task = Tasks.BOUNDINGBOX" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="959.0041299303944" y="438" width="306.96055684454757" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-48" value="&amp;nbsp;attach_index = -1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="959.0030858468676" y="385" width="233.06264501160095" height="40" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-39" value="&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 17px; background-color: rgb(223, 223, 223);&quot;&gt;EfficientBBoxHead&lt;/span&gt;&lt;span style=&quot;font-size: 17px;&quot;&gt;&amp;nbsp;node is a head that predicts bounding boxes.&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;position2=0.68;direction=west;" vertex="1" parent="1">
          <mxGeometry x="1049" y="470" width="271" height="110" as="geometry" />
        </mxCell>
        <mxCell id="a-gHkuGWtvwq_3vCU7H0-40" value="The&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;attach_index&lt;/span&gt;&amp;nbsp;is set to&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;-1&lt;/span&gt;, so the&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;unwrap&lt;/span&gt;&amp;nbsp;method extracts the last (deepest) feature from the feature list received from&amp;nbsp;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; background-color: rgb(223, 223, 223);&quot;&gt;RepPANNeck&lt;/span&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=38;position=0.51;position2=0.41;fontSize=17;base=41;" vertex="1" parent="1">
          <mxGeometry x="1026.5" y="260" width="370" height="138" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.328;exitY=0.911;exitDx=0;exitDy=0;exitPerimeter=0;dashed=1;strokeWidth=2;dashPattern=1 2;endArrow=block;endFill=0;entryX=0.993;entryY=0.433;entryDx=0;entryDy=0;entryPerimeter=0;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1" edge="1" target="_37iejXVek1QUt4RPsA0-68">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="761.9079999999999" y="1224.9499999999998" as="sourcePoint" />
            <mxPoint x="400" y="1170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="570" y="1225" />
              <mxPoint x="570" y="1010" />
              <mxPoint x="400" y="1010" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-76" value="The &lt;font face=&quot;Courier New&quot;&gt;predictions&lt;/font&gt;&amp;nbsp;argument is extracted from the wrapped packet based on the value of &lt;font face=&quot;Courier New&quot;&gt;&lt;span style=&quot;background-color: rgb(223, 223, 223);&quot;&gt;task&lt;/span&gt;.&lt;/font&gt;&amp;nbsp;Here the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;task&lt;/font&gt; is &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;BOUNDINGBOX&lt;/font&gt;, which matches the&amp;nbsp;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;predictions&lt;/font&gt;&amp;nbsp;argument to the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;&quot;boundingbox&quot;&lt;/font&gt; item in the packet" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=60;position=0.5;position2=0.66;fontSize=17;flipV=1;base=30;" parent="1" vertex="1">
          <mxGeometry x="120" y="1022" width="500" height="180" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-50" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1069" y="934" width="414" height="400" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-40" value="&lt;font face=&quot;Courier New&quot; style=&quot;font-size: 19px;&quot;&gt;AdaptiveDetectionLoss&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1149" y="954" width="245" height="30" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-54" value="&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp;def forward(&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;self,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;features: list[Tensor],&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;class_scores: Tensor,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;distributions: Tensor,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;target: Tensor,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp;): ...&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=light-dark(#E6E6E6,#515151);spacing=0;labelBorderColor=none;textShadow=1;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="1126.5" y="1096" width="290" height="195.5" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-59" value="" style="endArrow=block;html=1;rounded=0;entryX=0.095;entryY=0.317;entryDx=0;entryDy=0;entryPerimeter=0;strokeWidth=2;endFill=0;dashed=1;dashPattern=1 1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="974.5" y="1184" as="sourcePoint" />
            <mxPoint x="1154.5" y="1184" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-60" value="" style="endArrow=block;html=1;rounded=0;entryX=0.095;entryY=0.317;entryDx=0;entryDy=0;entryPerimeter=0;strokeWidth=2;endFill=0;dashed=1;dashPattern=1 1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="977.5" y="1202" as="sourcePoint" />
            <mxPoint x="1154.5" y="1202" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-61" value="" style="endArrow=block;html=1;rounded=0;entryX=0.095;entryY=0.317;entryDx=0;entryDy=0;entryPerimeter=0;strokeWidth=2;endFill=0;dashed=1;dashPattern=1 1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930.5" y="1164" as="sourcePoint" />
            <mxPoint x="1154.5" y="1164" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-62" value="The wrapped packet is used as &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;**kwargs&lt;/font&gt; to the &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;forward&lt;/font&gt;&amp;nbsp;/&amp;nbsp;&lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;update&lt;/font&gt; methods of the attached modules" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=80;position=0.26;position2=0.16;fontSize=17;base=29;flipH=1;flipV=1;" parent="1" vertex="1">
          <mxGeometry x="789" y="1210" width="350" height="173" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-49" value="The &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;target&lt;/font&gt;&amp;nbsp;argument is extracted from the labels based on the value of &lt;font style=&quot;background-color: rgb(223, 223, 223);&quot; face=&quot;Courier New&quot;&gt;supported_tasks&lt;/font&gt;" style="shape=callout;whiteSpace=wrap;html=1;perimeter=calloutPerimeter;align=center;size=60;position=0.22;position2=0.13;fontSize=17;flipV=1;base=21;" parent="1" vertex="1">
          <mxGeometry x="1169" y="1254" width="344" height="150" as="geometry" />
        </mxCell>
        <mxCell id="_37iejXVek1QUt4RPsA0-65" value="&amp;nbsp;supported_tasks = [Tasks.BOUNDINGBOX]" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;fontFamily=Courier New;textShadow=0;fillColor=#E6E6E6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1078.5" y="1019" width="395" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
