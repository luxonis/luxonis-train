loader:
  name: CustomReIDLoader

model:
  name: reid_test
  nodes:
    - name: GhostFaceNetV2

    - name: GhostFaceNetHead
      params:
        embedding_size: &embedding_size 512

      losses:
        - name: SupConLoss
          # params:
          #   embedding_size: *embedding_size
            # cross_batch_memory_size: &memory_size 4

      metrics:
        - name: ClosestIsPositiveAccuracy
          # params:
          #   cross_batch_memory_size: *memory_size
          is_main_metric: True

        - name: MedianDistances
          # params:
          #   cross_batch_memory_size: *memory_size

      visualizers:
        - name: EmbeddingsVisualizer

loader:
  params:
    dataset_name: reid_dataset

trainer:
  preprocessing:
    train_image_size: [256, 256]

  batch_size: 16
  epochs: 1
  n_workers: 0
  validation_interval: 1

  callbacks:
    - name: ExportOnTrainEnd

  optimizer:
    name: Adam
    params:
      lr: 0.01
