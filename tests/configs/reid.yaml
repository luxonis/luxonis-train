loader:
  name: CustomReIDLoader

model:
  name: reid_test
  nodes:
    - name: GhostFaceNetV2

    - name: GhostFaceNetHead
      params:
        embedding_size: 512
        cross_batch_memory_size: 4

      losses:
        - name: SupConLoss

      metrics:
        - name: ClosestIsPositiveAccuracy
          is_main_metric: True

        - name: MedianDistances

      visualizers:
        - name: EmbeddingsVisualizer

loader:
  train_view: val

  params:
    dataset_name: reid_dataset

trainer:
  preprocessing:
    train_image_size: [256, 320]

  batch_size: 16
  epochs: 1
  n_workers: 0
  validation_interval: 1

  callbacks:
    - name: ExportOnTrainEnd

  optimizer:
    name: Adam
    params:
      lr: 0.01
